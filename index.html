<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Sham - إدارة المصاريف</title>
<link rel="manifest" href="manifest.json">
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="app">
  <header class="header no-print">
    <div class="brand">
      <div class="logo"><img id="logoImg" src="icons/icon-purple-192.png" style="width:56px;height:56px"></div>
      <div>
        <div class="title">Sham - إدارة المصاريف</div>
        <div class="small">نسخة PWA احترافية</div>
      </div>
    </div>
    <div class="controls">
      <div class="theme-toggle">
        <button class="btn" onclick="setTheme(store.settings.theme==='purple'?'blackgold':'purple')">تبديل الثيم</button>
      </div>
      <button class="btn no-print" onclick="printReport()">طباعة</button>
    </div>
  </header>

  <div class="card header">
    <div>
      <div class="small">المبلغ الكلي المتاح</div>
      <div class="kpi" id="totalMoneyDisplay">0 د.ع</div>
      <div class="small">دخل إضافي: <span id="extraIncomeDisplay">0 د.ع</span></div>
    </div>
    <div style="min-width:260px">
      <div class="small">اختر الشهر</div>
      <select id="monthSelect" class="input"></select>
      <div style="margin-top:8px;display:flex;gap:8px">
        <input id="extraAmount" class="input" placeholder="دخل إضافي (د.ع)">
        <button class="btn" onclick="handleAddExtra()">إضافة دخل</button>
      </div>
    </div>
  </div>

  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <h3>الميزانيات</h3>
      <div style="display:flex;gap:8px;align-items:center">
        <input id="newCategoryInput" class="input" placeholder="أضف فئة جديدة">
        <button class="btn" onclick="addNewCategoryUI()">أضف فئة</button>
      </div>
    </div>
    <div id="budgetsContainer" class="budgets"></div>
  </div>

  <div class="card">
    <h3>أضف مصروف</h3>
    <div class="row">
      <div class="col"><input id="expDate" class="input" type="datetime-local" value=""></div>
      <div class="col"><input id="expAmount" class="input" type="number" placeholder="المبلغ (د.ع)"></div>
      <div class="col"><select id="expCategory" class="input"></select></div>
    </div>
    <div style="margin-top:8px;display:flex;gap:8px">
      <input id="expNote" class="input" placeholder="ملاحظة">
      <button class="btn" onclick="handleAddExpense()">أضف مصروف</button>
    </div>
  </div>

  <div class="card">
    <h3>سجل المصاريف</h3>
    <div id="historyList"></div>
  </div>

  <div class="card">
    <h3>تقارير ومخططات</h3>
    <canvas id="monthlyChart" style="max-width:100%;height:240px"></canvas>
    <canvas id="catChart" style="max-width:100%;height:240px;margin-top:12px"></canvas>
  </div>

  <footer>
    <div class="small">العملة: دينار عراقي (د.ع) — يمكنك التبديل بين ثيم بنفسجي وأسود/ذهبي</div>
  </footer>
</div>

<script src="app.js"></script>
</body>
</html>
